# 学生作业保护系统 - VBA代码

## 功能说明

这是一个用于学生Word作业保护的VBA系统，具有以下功能：

### 核心功能

1. **学生登录验证**
   - 学生需要输入学号和姓名登录
   - 首次登录的学生可以编辑文档
   - 第二次登录的学生（Returning学生）只能读取，不能编辑和复制

2. **水印功能**
   - 自动在文档中添加学生学号和姓名水印
   - 页眉显示学生信息
   - 每页有对角线倾斜水印

3. **防复制功能**
   - 禁用复制快捷键 (Ctrl+C, Ctrl+X)
   - 禁用右键菜单的复制功能
   - 对文档进行保护

4. **老师功能**
   - 查看所有已登录学生记录
   - 导出学生登录记录
   - 重置学生记录（需要密码）

## 文件说明

| 文件名 | 说明 |
|--------|------|
| `MainModule.bas` | 主模块，包含系统入口和全局变量 |
| `LoginForm.bas` | 登录窗体，处理学生登录界面 |
| `StudentStorage.bas` | 学生信息存储模块，保存和验证学生登录状态 |
| `WatermarkManager.bas` | 水印管理模块，添加/删除水印 |

## 使用方法

### 1. 导入VBA代码到Word文档

1. 打开Word文档
2. 按 `Alt + F11` 打开VBA编辑器
3. 在菜单中选择 `文件` -> `导入文件`
4. 依次导入以下文件：
   - `MainModule.bas`
   - `LoginForm.bas`
   - `StudentStorage.bas`
   - `WatermarkManager.bas`

### 2. 保存文档

将文档保存为 `.docm` 或 `.doc` 格式（启用宏的文档）

### 3. 首次使用

1. 打开文档时，会自动弹出登录窗体
2. 学生输入学号和姓名
3. 首次登录后，可以看到水印，且可以编辑文档
4. 文档会自动记录学生的登录信息

### 4. 再次使用

1. 再次打开文档时，输入相同的学号和姓名
2. 系统会识别为Returning学生
3. 文档将变为只读模式，无法复制和编辑

## 老师功能

### 查看学生记录

在VBA编辑器中运行 `ViewAllStudents` 过程，可以查看所有已登录学生的记录。

### 导出学生记录

运行 `ExportStudentRecords` 过程，可以将学生登录记录导出到文本文件。

### 重置学生记录

运行 `TeacherReset` 过程，输入老师密码 `Teacher2024`，可以清除所有学生记录，让学生可以重新编辑文档。

## 密码说明

| 密码 | 用途 |
|------|------|
| `Teacher2024` | 老师重置密码 |

## 注意事项

1. **宏安全性**：确保Word的宏安全性设置为"启用所有宏"或"禁用所有宏，并发出通知"
2. **首次运行**：首次打开文档时需要启用宏
3. **文档保护**：系统会自动保护文档，防止未经授权的操作
4. **学生验证**：学号和姓名必须同时匹配才能识别为同一学生

## 技术细节

- 学生信息存储在文档的书签中
- 使用文档保护机制限制编辑和复制
- 水印通过Word形状和页眉实现
- 支持多页文档，每页都有水印
